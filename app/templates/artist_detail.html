{% extends "base.html" %}

{% block content %}
<h2>{{ artist.name }}</h2>

<h3>Releases</h3>

<!-- Bulk Delete Form -->
<form action="/releases/delete-multiple" method="post">
    <label>
        <input type="checkbox" id="check-all"> Check All
    </label>

    <ul>
        {% for release in releases %}
        <li>
            <input type="checkbox" name="release_ids" value="{{ release.id }}">
            {{ release.title }} {% if release.year %}({{ release.year }}){% endif %}
            <button type="button" onclick="deleteSingle(release.id)" title="Delete
                style="background:none; border:none; color:red; cursor:pointer;">üóëÔ∏è</button>
        </li>
        {% else %}
        <li>No releases yet.</li>
        {% endfor %}
    </ul>

    <button type="submit" onclick="return confirm('Delete selected releases?')">Delete Selected</button>
</form>

<!-- Add Release Form -->
<h3>Add Release</h3>
<form action="/artists/{{ artist.id }}/releases" method="post">
    <input type="text" name="title" placeholder="Release Title" required>
    <input type="number" name="year" placeholder="Year">
    <button type="submit">Add Release</button>
</form>
<h3>Releationship</h3>
<form action="/artists/{{ artist.id }}/id_deezer" method="post">
    <input type="text" name="id_deezer" placeholder="Deezer ID"
           value="{{ artist.id_deezer or '' }}">
    <button type="submit">Save</button>
</form>

<form action="/artists/{{ artist.id }}/id_discogs" method="post">
    <input type="text" name="id_discogs" placeholder="Discogs ID"
           value="{{ artist.id_discogs or '' }}">
    <button type="submit">Save</button>
</form>

<form action="/artists/{{ artist.id }}/id_spotify" method="post">
    <input type="text" name="id_spotify" placeholder="Spotify ID"
           value="{{ artist.id_spotify or '' }}">
    <button type="submit">Save</button>
</form>

<form action="/artists/{{ artist.id }}/id_musicbrainz" method="post">
    <input type="text" name="id_musicbrainz" placeholder="MusicBrainz ID"
           value="{{ artist.id_musicbrainz or '' }}">
    <button type="submit">Save</button>
</form>


<!-- Hidden form for single delete -->
<form id="single-delete-form" method="post" style="display:none;"></form>

<!-- JavaScript -->
<script>
    // Check All toggle
    document.getElementById('check-all').addEventListener('change', function () {
        const checkboxes = document.querySelectorAll('input[name="release_ids"]');
        checkboxes.forEach(cb => cb.checked = this.checked);
    });

    // Submit single delete
    function deleteSingle(id) {
        if (confirm('Delete this release?')) {
            const form = document.getElementById('single-delete-form');
            form.action = `/releases/${id}/delete`;
            form.submit();
        }
    }
</script>

{% endblock %}